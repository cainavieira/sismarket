Hereby I will post some functions I used in order to make the connection with the database postgres in neon.tech serve and how I converted all my data in csv to database data.

"""
def criar_tabela_estoque():
    try:
        conn = get_conn()
        cursor = conn.cursor()
        cursor.execute("CREATE TABLE IF NOT EXISTS sismarket.estoque (id_product INTEGER PRIMARY KEY, product VARCHAR(100), stock_count SMALLINT, price DECIMAL(10,2));")
        print("Yeah, we have made it") 
        conn.commit()
    except Exception as error:
        print(error)
        exit()
    finally:
        cursor.close()
        conn.close()
"""

"""
def ler_arq(arq):
    file = pathlib.Path(__file__).parent / pathlib.Path(arq)
    if file.exists():
        return file
    else:
        print("File cannot be found")
        return None
       
file = ler_arq(arq= "estoque.csv")

def inserir_produtos(file):
    conn = get_conn()
    cursor = conn.cursor()
    try:
        with open(file, newline= "", encoding="UTF-8") as f:
            reader = csv.DictReader(f,fieldnames=["id_product", "product", "stock_count", "price"])
            for col in reader:
                cursor.execute('''
                               INSERT INTO sismarket.estoque (id_product, product, stock_count, price) VALUES (%s,%s,%s,%s)
                               ''', 
                               (col["id_product"], col["product"], col["stock_count"], col["price"])
                               )
        conn.commit()
    except Exception as error:
        print("Error ao inserir dados no data base: ", error)
    finally:
            cursor.close()
            conn.close()
        
"""